# android/app/src/main/jni/CMakeLists.txt

cmake_minimum_required(VERSION 3.18)
project(appmodules LANGUAGES CXX)

find_package(ReactAndroid REQUIRED)

# Define a variable that points to the folder where Codegen files are created
set(
        generated_sources_dir
        "${CMAKE_BINARY_DIR}/codegen/jni"
)

# Check if the main C++ file generated by Codegen exists.
# This `if` block is the key to the solution.
if(EXISTS "${generated_sources_dir}/react/renderer/components/appmodules/AppModulesJni.cpp")

    # If the file exists, then create the library and link it.
    add_library(
            appmodules
            SHARED
            "${generated_sources_dir}/react/renderer/components/appmodules/AppModulesJni.cpp"
    )

    target_link_libraries(
            appmodules
            ReactAndroid::react_native_modules
    )

endif()